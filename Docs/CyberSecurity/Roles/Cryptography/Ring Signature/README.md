# Implementing Ring Signature of 2 Users

- Add-on Resources
    + message.txt : Contains the message to be signed and verified
    - publickey.txt
        - User-1
            + line 1 = e1 = Public Exponent of User 2's RSA key
            + line 2 = n1 = Modulus of User 1's RSA Key
        - User-2
            + line 3 = e2 = Public Exponent of User 2's RSA key
            + line 4 = n2 = Modulus of User 2's RSA key
    - privateKey.txt
        - line 1: Private Key for User-1
        - line 2: Private Key for User-2

### System
+ OS: Windows 10
+ Language: Python 3.10.0

### Application
- Intended Output: 
    - User 1
        - Valid Output
            - Private Key Used: 79057507761770569178444677312084890651
            ```
            $ python ring-signature.py

            1. Setup...
            Who will be the signer? (User-1 | User-2): User-1
            Please enter the signer's private key: 79057507761770569178444677312084890651
            Message    : ringsignature
            2. Reconstructing Public-Private Key Pair...
            Private Key: Private RSA key at 0x240B88E53C0
            Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAMKQhGPlv00yu0BOpwKoMEkCCQDH3hwo
            W50IHw==
            -----END PUBLIC KEY-----
            User [User-1] Private Key: Private RSA key at 0x240B83A8EE0
            User [User-1] Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAMKQhGPlv00yu0BOpwKoMEkCCQDH3hwo
            W50IHw==
            -----END PUBLIC KEY-----
            User [User-1] Exponent   : 14401979618038712351
            User [User-1] Modulus    : 258620607122661802093196014485131243593

            Participant Public Keys: [{'e': 14401979618038712351, 'n': 258620607122661802093196014485131243593}]
            Signer Key Pair: {'e': 14401979618038712351, 'd': 79057507761770569178444677312084890651, 'n': 258620607122661802093196014485131243593}
            User [User-1] Private Key: Private RSA key at 0x240B83A8EE0
            User [User-1] Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAMKQhGPlv00yu0BOpwKoMEkCCQDH3hwo
            W50IHw==
            -----END PUBLIC KEY-----
            User [User-1] Exponent   : 14401979618038712351
            User [User-1] Modulus    : 258620607122661802093196014485131243593


            3. Signing the message with a Digital Signature...
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            <class 'list'> : [279809547151112900931229605700955332889405828175631170040761898667143537899687458298111985283165728114833357667296835599567906922760027585697487244690115667671876243852406021136046472748256374274240834843275902963079395440548051089135853863571511845704337633793792185960109840052836957933593352905994238260821178986212018128782387192803934919796606554209772135746389711978147434893291537463884168475113660967858849358991616166602678178728191251168086406786478911115294037723322902668477531894786224290949374512973255013859860478628362720892069916356774033224213087723527560447042939818556847324560385559700045156395580228896394278413083303090567674083182996291232555763028718762621344292059535440911046727493610100700924275203695982224097524347275186066685076276611390714, 3336283696498656298692323125904967984783967399726658871907666490029503486332235836952273761314369056730611488216667027933783724480211772158837368220468700467936216579426959998533361309333017887796932556549833250706140235030620618139722168067158267330714185488623138982236684894984577696542921904951074854113472708448741305766995927059029622577071565804602479293842739401049546950308565899197741722185952208920935636579643700405568811158676587890046628922190178813731555878847011913789476521079599551466065163329136224334350869208751954410911577390840140223431256011893162183760074155931035830174127066858507230086313632814739092160680377142099686450092262185397118585078635823651482936819511963018858330893807129420270296589032807194888882933957358770960383692973354435589086020491214768141313622107717773753458091316920525429969592991556079191768415608589223685464202019298967849086951560976421998793576329753094493036392264986365828578645530350371053164365079292097049195031156262824022785686632515943599105437936026178657841371135115591384505966234609356043071977151135095298546384920145135951248316055253133518477067115643138697008855565905659691799864182833461913801098551543862035264536726868905506668644394007697729269653801791469486686239391465102098712776711774408178386913921758907463286899352982392478456270365892528001984331251539680415516754007122912211613707011898462298325804860301528539344449699303526433005169430105152097841017117133624892750404283362171687337852867868625512741926608003288083734815332494700056910105513741154999716684222694543604192943704719489322390218887995159264319717995958148894955662736950758746989960482695621356304839664973755652110551114800995003803668204351006727649430513700181560838670954942774196132115634113843283546484577329800699112285438367021277120613409681567351731402228081351751934531194220050479733575222709503049811641228962056454]
            <class 'dict'> : {'e': 14401979618038712351, 'd': 79057507761770569178444677312084890651, 'n': 258620607122661802093196014485131243593}
            Signature: {'msg': 'ringsignature', 'rows': [{'e': 14401979618038712351, 'n': 258620607122661802093196014485131243593, 's': 28479743415697341890993235786756650507605433800601876016791623401121208084972677504649710584124754745333782403998879497121191796205507759806335135601524106210103999922536639007433879893954945040200615136751831695359152340726421847302220785955832949107061806859723325873322131531713030540429990465794247187069}, {'e': 14401979618038712351, 'n': 258620607122661802093196014485131243593, 's': 3336283696498656298692323125904967984783967399726658871907666490029503486332235836952273761314369056730611488216667027933783724480211772158837368220468700467936216579426959998533361309333017887796932556549833250706140235030620618139722168067158267330714185488623138982236684894984577696542921904951074854113472708448741305766995927059029622577071565804602479293842739401049546950308565899197741722185952208920935636579643700405568811158676587890046628922190178813731555878847011913789476521079599551466065163329136224334350869208751954410911577390840140223431256011893162183760074155931035830174127066858507230086313632814739092160680377142099686450092262185397118585078635823651482936819511963018858330893807129420270296589032807194888882933957358770960383692973354435589086020491214768141313622107717773753458091316920525429969592991556079191768415608589223685464202019298967849086951560976421998793576329753094493036392264986365828578645530350371053164365079292097049195031156262824022785686632515943599105437936026178657841371135115591384505966234609356043071977151135095298546384920145135951248316055253133518477067115643138697008855565905659691799864182833461913801098551543862035264536726868905506668644394007697729269653801791469486686239391465102098712776711774408178386913921758907463286899352982392478456270365892528001984331251539680415516754007122912211613707011898462298325804860301528539344449699303526433005169430105152097841017117133624892750404283362171687337852867868625512741926608003288083734815332494700056910105513741154999716684222694543604192943704719489377068142254667678791902495080488465275730555373051497658103910189891325146043369799716348194116833863490685199016319272885046385441806443653026083961805614211297485543665647942601506432140586307382874248587770238581603360268434060890742467291915935148369492487832787501089039386979403632928290432757505880340}], 'v': 279809547151112900931229605700955332889405828175631170040761898667143537899687458298111985283165728114833357667296835599567906922760027585697487244690115667671876243852406021136046472748256374274240834843275902963079395440548051089135853863571511845704337633793792185960109840052836957933593352905994238260821178986212018128782387192803934919796606554209772135746389711978147434893291537463884168475113660967858849358991616166602678178728191251168086406786478911115294037723322902668477531894786224290949374512973255013859860478628362720892069916356774033224213087723527560447042939818556847324560385559700045156395580228896394278413083303090567674083182996291232555763028718762621344292059535440911046727493610100700924275203695982224097524347275186066685076276611390714}

            4. Verifying the message with Public Key and Signature...
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Verified : True
            ```
        - Invalid Output
            - Private Key Used: 113906104729633908562188939706913423521
            ```
            $ python ring-signature.py

            1. Setup...
            Who will be the signer? (User-1 | User-2): User-1
            Please enter the signer's private key: 113906104729633908562188939706913423521
            Message    : ringsignature
            2. Reconstructing Public-Private Key Pair...
            Traceback (most recent call last):
                ...
            ValueError: Unable to compute factors p and q from exponent d.
            ```
    - User 2
        - Valid Output
            - Private Key Used: 113906104729633908562188939706913423521
            ```
            1. Setup...
            Who will be the signer? (User-1 | User-2): User-2
            Please enter the signer's private key: 113906104729633908562188939706913423521
            Message    : ringsignature
            2. Reconstructing Public-Private Key Pair...
            Private Key: Private RSA key at 0x1B5063654E0
            Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAKGKQTHqtZXQ7h3cbpw3C+UCCQDSjfQ1
            Cv1nYQ==
            -----END PUBLIC KEY-----
            User [User-2] Private Key: Private RSA key at 0x1B505DF8EE0
            User [User-2] Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAKGKQTHqtZXQ7h3cbpw3C+UCCQDSjfQ1
            Cv1nYQ==
            -----END PUBLIC KEY-----
            User [User-2] Exponent   : 15172051228335892321
            User [User-2] Modulus    : 214723566599292477666012065247475993573

            Participant Public Keys: [{'e': 15172051228335892321, 'n': 214723566599292477666012065247475993573}]
            Signer Key Pair: {'e': 15172051228335892321, 'd': 113906104729633908562188939706913423521, 'n': 214723566599292477666012065247475993573}
            User [User-2] Private Key: Private RSA key at 0x1B505DF8EE0
            User [User-2] Public Key : -----BEGIN PUBLIC KEY-----
            MDIwDQYJKoZIhvcNAQEBBQADIQAwHgIRAKGKQTHqtZXQ7h3cbpw3C+UCCQDSjfQ1
            Cv1nYQ==
            -----END PUBLIC KEY-----
            User [User-2] Exponent   : 15172051228335892321
            User [User-2] Modulus    : 214723566599292477666012065247475993573


            3. Signing the message with a Digital Signature...
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            <class 'list'> : [136736376722554615397013053384354910480489485723348479906236436392447811621063205428024479645579635947927326997089692036531120410975411173628030121291147831774336182682398931357660717571137335427203991956198921603330484944946489527269985087412726426396417387603415172691631468995608126714600681275732147813981215847471739597591255286557470773088857015874125685780239320398923025985660945711241418585232985999848111227235707004803679441490073478907327270001016426729128218240597135891716113402050070158772088143417899811958921707093129461513004661974373284223188130113870677747050047060194736872912859454931239888886742371549242602725498691795075494885390103730948353853004754619314432796045176913867878919412953050907614402864882865151358170916979819745144554658205386693, 1376208501130972240467241304469874560702932624086625433242157723213365638145496179203251482690083287641075736611917409427562005739503187982792544314332809293354664129155570378320376056144459523600092175953418085820779993548340110327183556563098189625975455040883821819413437709920602954875625004564945754181078091051518532750480342653638436505122987508683811458964270079767765872038421561646909693225855844090135176312301264233557623771532554110219308870726953842369670800389173620653268820695162625172229228564850201477311658429350270534130958938198881051162869629214417450114665379117994589071125220343139807144253674751248463131949180589072583025230971111780724405400279885953198570777973203121569401996891049991491399395492267162653329140412359829583038240433471137065010454012289248505915011395592375220472320235492141014385118429409731884062306770308862135362780790247412147303041926063440361106059971530939265015309385513422378432670758599400519984456069657663102612395021612671909501175150035517340727178274546597486132561492302700150534007604423445653185188102878397211175436507794947563772154407766831667946771230570188362334680448676218435039663052164318206011575344247418810215838477965726903391734577908805601865349206077494363367145399836053965855270202586873071669242435781094982404221295372522545967894907632145817749975445810650016645703825326386681771712575840961284549784206725859325586719761270516128989429693966349481146093564053598617786231638760457260860474947936824454799201228945085435091053359227868826483765996138518783106845298685149078467926769090896229700296945871596495259378778339152623611789908882871898359539233271338165599926742378908601478343726487104632986220512725127434136095581415873206964102438695168140782258438072608825718813194174705025918483363501627006996692166697984503391465630930765227268635905244317175311139246802428988325258946460155174]
            <class 'dict'> : {'e': 15172051228335892321, 'd': 113906104729633908562188939706913423521, 'n': 214723566599292477666012065247475993573}
            Signature: {'msg': 'ringsignature', 'rows': [{'e': 15172051228335892321, 'n': 214723566599292477666012065247475993573, 's': 2638844134137504888326594744601447280810837340993124194385069497912142438361288525222949533081008253356809963692222745950275927180158606184673995222061899480867169696016193579767597431460690958633420102696919730883507939836607263256372256476083121729660002140928191933795474176417137457320122061398626697612}, {'e': 15172051228335892321, 'n': 214723566599292477666012065247475993573, 's': 1376208501130972240467241304469874560702932624086625433242157723213365638145496179203251482690083287641075736611917409427562005739503187982792544314332809293354664129155570378320376056144459523600092175953418085820779993548340110327183556563098189625975455040883821819413437709920602954875625004564945754181078091051518532750480342653638436505122987508683811458964270079767765872038421561646909693225855844090135176312301264233557623771532554110219308870726953842369670800389173620653268820695162625172229228564850201477311658429350270534130958938198881051162869629214417450114665379117994589071125220343139807144253674751248463131949180589072583025230971111780724405400279885953198570777973203121569401996891049991491399395492267162653329140412359829583038240433471137065010454012289248505915011395592375220472320235492141014385118429409731884062306770308862135362780790247412147303041926063440361106059971530939265015309385513422378432670758599400519984456069657663102612395021612671909501175150035517340727178274546597486132561492302700150534007604423445653185188102878397211175436507794947563772154407766831667946771230570188362334680448676218435039663052164318206011575344247418810215838477965726903391734577908805601865349206077494363367145399836053965855270202586873071669242435781094982404221295372522545967894907632145817749975445810650016645703825326386681771712575840961284549784206725859325586719761270516128989429693966349481146093564053598617786231638760457260860474947936824454799201228945085435091053359227868826483765996138518783106845298685149078467926769090896185588859673417329813731597744849692361072968531149706563202150473340016311091948515780274261530253333690905958736387267600230287222414695395062210439222279110564225260955297150041536331754954832960702400640756329613706133297361624858659426017391782150148327873357819225194391786384720852297967732411599066401}], 'v': 136736376722554615397013053384354910480489485723348479906236436392447811621063205428024479645579635947927326997089692036531120410975411173628030121291147831774336182682398931357660717571137335427203991956198921603330484944946489527269985087412726426396417387603415172691631468995608126714600681275732147813981215847471739597591255286557470773088857015874125685780239320398923025985660945711241418585232985999848111227235707004803679441490073478907327270001016426729128218240597135891716113402050070158772088143417899811958921707093129461513004661974373284223188130113870677747050047060194736872912859454931239888886742371549242602725498691795075494885390103730948353853004754619314432796045176913867878919412953050907614402864882865151358170916979819745144554658205386693}

            4. Verifying the message with Public Key and Signature...
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Key       : 111119255625782624418302837132739007997537560861450650908399315267670789598295
            Key Length: 78
            Verified : True
            ```
        - Invalid Output
            - Private Key Used: 79057507761770569178444677312084890651
            ```
            1. Setup...
            Who will be the signer? (User-1 | User-2): User-2
            Please enter the signer's private key: 79057507761770569178444677312084890651
            Message    : ringsignature
            2. Reconstructing Public-Private Key Pair...
                ...
            ValueError: Unable to compute factors p and q from exponent d.
            ```

## Setup
### Dependencies
+ python3
- Python dependencies
    + cryptography
    + pycryptodome (For Crypto)
    + hashlib
    + base64

### Pre-Requisites
- (Optional) Create a python Virtual Environment
    - Initialize Virtual Environment
        python -m venv env
    - Source the virtual environment
        - If Operating System is Windows
            env\Scripts\activate
        - If Operating System is UNIX-based (Linux etc)
            env/bin/activate
- Install dependencies
    python -m pip install -Ur requirements.txt

## Documentation
### Synopsis/Syntax
python ring-signature.py

### Usage
- Running the application
    python ring-signature.py

## Resources

## References

## Remarks
