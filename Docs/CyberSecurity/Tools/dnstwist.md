# dnstwist

## Information
+ Author: elceef
+ Project Name: dnstwist
+ Utility type: Monitoring and Cyber Threat Intelligence Gathering
+ Targets: DNS Domain Name Typosquatting intelligence gathering
+ Repository: https://github.com/elceef/dnstwist
+ Website: https://dnstwist.it

### Summary
- dnstwist is a Typosquatting DNS (Domain Name) intelligence gathering CLI utility that allows you to detect typosquat domains, phishing attacks, fraud and brand impersonation.
    + Useful as an additional source of targeted threat intelligence

### Key features
+ Variety of highly effective domain fuzzing algorithms
+ Unicode domain names (IDN)
+ Additional domain permutations from dictionary files
+ Efficient multithreaded task distribution
- Live phishing webpage detection:
    + HTML similarity with fuzzy hashes (ssdeep/tlsh)
    + Screenshot visual similarity with perceptual hashes (pHash)
+ Rogue MX host detection (intercepting misdirected e-mails)
+ GeoIP location
+ Export to CSV and JSON

## Setup
### Dependencies
+ git
+ python
+ python-pip

### Pre-Requisites
- Create resource storage folder to hold the output data
    ```bash
    mkdir -pv output
    ```

- Create a new python Virtual Environment
    - Generate new virtual environment
        ```bash
        python -m venv env
        ```

    - Chroot into virtual environment
        - Linux
            ```bash
            . env/bin/activate
            ```
        - Windows
            ```bash
            .\env\Scripts\activate
            ```

### Build from Source
#### Linux

#### Windows

### Installation
- Using Python PyPI
    - Version
        + Default (base): Bare minimum
        + full: Install everything
    ```bash
    pip install dnstwist{full}
    ```

- Using package manager
    - apt-based
        ```bash
        apt install dnstwist
        ```
    - archlinux-based
        ```bash
        pacman -S python3-dnstwist
        ```
    - dnf-based
        ```bash
        dnf install dnstwist
        ```
    - brew-based
        ```bash
        brew install dnstwist
        ```

- Using git
    - Clone repository
        ```bash
        git clone https://github.com/elceef/dnstwist
        ```

    - Change directory into repository
        ```bash
        cd dnstwist
        ```

    - Install the package locally as development
        ```bash
        pip install .
        ```

### Docker
#### Setup

** Dependencies **
-------------------
+ docker
+ docker-compose

** Pre-Requisites **
-------------------
- Add user to 'dockeruser' group
    ```bash
    sudo usermod -aG dockeruser [username]
    ```

- Enable docker service
    ```bash
    service docker start
    ```

#### Using docker run
- Pull docker image
    ```bash
    docker pull elceef/dnstwist
    ```

- Startup and run a new container
    ```bash
    docker run -dit \
        --name=dnstwist \
        --restart=unless-stopped \
        elceef/dnstwist
    ```

- Start a stopped container
    ```bash
    docker start dnstwist
    ```

- Stop the running container
    ```bash
    docker stop dnstwist
    ```

- Restart the running container
    ```bash
    docker restart dnstwist
    ```

- Remove the container
    ```bash
    docker rm dnstwist
    ```

#### Using docker-compose
- Design docker-compose.yaml
    ```yaml
    version: "3.7"
    services:
        dnstwist:
            image: elceef/dnstwist
            container_name: dnstwist
            restart: unless-stopped
            # ports:
                ## Port Forward/Translate/Map from host system to container
                ## [host-ip-address]:[host-system-port]:[container-port]
            # volumes:
                ## Mount volumes from host system into container
                ## [host-system-volume]:[container-volume]:[permissions]
    ```

- Startup docker compose environment
    ```bash
    docker-compose up -d
    ```

- Start a stopped container
    ```bash
    docker-compose start dnstwist
    ```

- Stop the running container
    ```bash
    docker-compose stop dnstwist
    ```

- Restart the running container
    ```bash
    docker-compose restart dnstwist
    ```

- Shutdown the docker compose environment
    ```bash
    docker-compose down
    ```

## Documentations
### Synopsis/Syntax
```console
dnstwist {options} <arguments> [domain-name|ip]
```

### Parameters
- Positionals

- Global Options
    - With Arguments
        - Dictionary Search
            + `--dictionary [dictionary-file]` : Specify a dictionary file to provide dnstwist to use as a lookup table; If domain permutations generated by the fuzzing algorithms are insufficient. Some dictionary samples with a list of the most common words used in phishing campaigns are included
            + `--tld [common-tld-dictionary-file]` : Specify a dictionary file containing common Top-level Domains to provide dnstwist to use as a lookup table; If you need to check whether domains with different Top-level Domains (TLD) exist. This dictionary file contains a list of TLDs
        - HTML Source Code Detection
            - --lsh {algorithms} : Detecting similar HTML source code; Use '--lsh-url [domain]/owa/' to override the URL used to fetch the original web page form
                + Default: tlsh
            - `--lsh-url [URL]` : Explicitly specify and override the URL used to fetch the original web page form
                - URLs Format
                    + https://different.domain/owa/
        - Output Options
            - `--format [format]` : Default output method is Standard Output; Specify the custom output format to print the results
                - Formats
                    + csv : Export results to CSV
                    + json : Export results to JSON
                    + list : Display results to standard output as a list with just the bare permutations withoout making any DNS lookups
            + `--screenshots [directory]` : Save/Capture screenshots of the domains to the specified directory/paths
        - Uncategorised
            - `--fuzzers [fuzzy-algorithms,...]` : Specify required fuzzy search algorithms; Please separate all algorithms with a comma-delimited (x,y) list
                - Fuzzy Algorithms
                    + homoglyph
                    + hyphenation
    - Flags
        - --geoip : Perform real-time lookups to return Geographical Location tracking (approximated to the country) of IPv4 addresses
            + Default: GeoIP2 library
            - Customs
                + Set the '$GEOLITE2_MMDB' environment variable to set a custom country database location
        + --phash : Perceptual Hashing; dnstwist can utilize its headless mode, which operates without a graphical user interface, to capture web page screenshots, render them, and calculate pHash values. These pHash values are then compared to evaluate the visual similarity, expressed as a percentage. Requires Chromium Browser to be installed
        + --registered : Display only the domains that are registered

### Usage
- Searching domains using dictionary as lookup table
    ```bash
    dnstwist --dictionary dictionaries/english.dict [domain-name]
    ```

- Search for domains with different Top-level Domains
    ```bash
    dnstwist --dictionary dictionaries/common_tlds.dict [domain-name]
    ```

- Exporting results 
    - to a list
        ```bash
        dnstwist --format list [domain-name]
        ```
    - to CSV
        ```bash
        dnstwist --format csv [domain-name] | column -t -s,
        ```
    - to JSON
        ```bash
        dnstwist --format json [domain-name] | jq
        ```

- Save/Capture screenshots of the domains to the specified directory/paths
    ```bash
    dnstwist --screenshots [directory] [domain-name]
    ```

### Operational Workflows

## Wiki
### Terminologies

## Resources

## References

## Remarks

