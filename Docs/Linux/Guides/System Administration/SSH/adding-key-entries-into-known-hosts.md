# SSH - Adding key entries into your known hosts

## Information
### Basics
```
SSH is the Secured SHell Protocol that is an application layer protocol assigned to the port number 22.

SSH is a protocol designed as a descendent of the remote network terminal access CLI utility 'telnet' that was not encrypted, as such, SSH was designed to be telnet with encryption and cryptographic capabilities.
```

### Background
- ssh-keyscan is used to, based on the parameters provided, generate a public key corresponding to the server's private key for the user to add into the client-side to establish a secured communication via a public-private key pair

### SSH Filesystem Structure
- SSH folders
    + Windows: %HOMEDIR%\.ssh
    + *NIX   : ~/.ssh

- SSH Configuration Files
    - .ssh
        + known_hosts : this configuration file contains all public-private key pair entries generated by SSH; place your key-pair entries here to be granted authentication/authorization

## Documentation

### Synopsis/Syntax
```console
ssh-keyscan {options} [hostname|ip-address]
```

### Parameters
- Positionals
    + hostname|ip-address : The IP address/hostname you wish to SSH into
- Optionals
    - With Arguments
        + -p [port-number] : Explicitly specify port number to scan in the specified host/ip address; Optional - if you are SSH-ing into the host using an external port number/forwarding
        - -t [public-private-keypair-encryption-scheme] : Specify the Public-Private Key Pair Encryption Scheme/Type to generate the keys with
            - Types
                + ecdsa : ECDSA
                + rsa : RSA Public Key Encryption Scheme
                + sha256
        + -T [timeout] : Timeout (in Seconds) before the scanning attempt stops
    - Flags
        + -H 

### Usage
- Generate an ECDSA public-private key pair entry for the target host
    ```console
    ssh-keyscan -H -t ecdsa -T 10 -p 5555 192.168.1.X
    ```

- Generate a RSA public-private key pair entry for the target host
    ```console
    ssh-keyscan -H -t rsa -T 10 -p 5555 192.168.1.X
    ```

## Wiki
### Steps
- Scan SSH host and generate key pair entry
    + Take note of the output section 'encryption-scheme-used public-key-used='
    ```console
    ssh-keyscan {options} [hostname|ip-address]
    ```

- Open the 'known_hosts' SSH file
    ```console
    $EDITOR ~/.ssh/known_hosts
    ```

- Add the output section highlighted previously into the known_hosts file in the following format:
    + Standalone Host (no ports): `hostname encryption-scheme-used public-key-used=`
    + Port in host: `[hostname]:[port-number] encryption-scheme-used public-key-used=`

- Test
    + Attempt to ssh

## Resources

## References
+ [GitHub - ansible/ansible-modules-extras - known_hosts doesnt support entries with SSH port specified](https://github.com/ansible/ansible-modules-extras/issues/2651)

## Remarks